<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>Docházka – Kalendář</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #calendar { max-width: 900px; margin: 0 auto; }
  </style>
</head>
<body>
  <h2>Docházka – Kalendář</h2>
  <div id="calendar"></div>

  <!-- FullCalendar + Firebase -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD4j1bO7JDbzUM-ca4AWUSkGYpmglWK_IQ",
      authDomain: "dochazka-app.firebaseapp.com",
      projectId: "dochazka-app",
      storageBucket: "dochazka-app.firebasestorage.app",
      messagingSenderId: "912220280247",
      appId: "1:912220280247:web:e0b27491b9234cba984432",
      measurementId: "G-G8PPKTK907"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const auth = firebase.auth();

    document.addEventListener('DOMContentLoaded', function () {
      const calendarEl = document.getElementById('calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        selectable: true,
        select: function (info) {
          const start = info.startStr;
          const endDate = new Date(info.end);
          endDate.setDate(endDate.getDate() - 1);
          const end = endDate.toISOString().split('T')[0];

          const typ = prompt("Zadej typ volna: dovolená / neplacené");
          const user = auth.currentUser;

          if (user && typ) {
            db.collection("zadosti").add({
              email: user.email,
              od: start,
              do: end,
              typ: typ,
              stav: "čeká na schválení"
            }).then(() => alert("Žádost byla uložena."));
          } else {
            alert("Musíš být přihlášený a zadat typ volna.");
          }
        }
      });
      calendar.render();
    });
  </script>
</body>
</html>
